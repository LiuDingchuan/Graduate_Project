clc
clear
format short
%通过count_coeff得到的K_coeff
K_coeff = [-99.0512848225234	161.375030514160	-156.389621410455	-10.0590062880495
63.9928715566516	-46.4720626070421	-6.92353815607583	26.1259067572226
11.5441042370362	-14.8597922303923	-19.3625779434887	-0.299053916534314
19.3165893080792	-23.0045086815708	10.9657841994598	2.24279288946326
-32.6142934810401	41.5073390771139	-19.0900634077401	-6.61000745160173
-81.5303433266699	118.703731238366	-67.0637667898665	17.9908215640236
-37.1793756145752	50.2424056321152	-28.6464352051342	-8.20377989047164
-89.8958812316146	132.980675257207	-76.7425492354827	22.0219844113493
-40.7651716632755	59.3518656190949	-33.5318833948964	8.99541078200716
65.2285869732094	-83.0146781649621	38.1801268189101	13.2200149028407
-7.00458321609559	9.95334225805404	-5.55431360604017	1.53156019003240
11.6338020785579	-14.8445886620617	6.88039672819413	1.30268222126150];
%已知量
global l0 l1 l2 l3 l4 l5 xc yc theta0 theta1 theta2 theta3 theta4;
l1 = 0.180;%单位为m
l2 = 0.200;
l3 = 0.200;
l4 = 0.180;
l5 = 0.120;
G_up = 15.245 * 9.8;
theta1 = deg2rad(-45)+pi;
theta4 = deg2rad(45);
pitch = deg2rad(0);
%根据已知信息求解足端点相对腿部坐标系的坐标
K_real = [ -44.0953   -6.8365   -9.4448  -13.1763    3.2857    0.5899
   21.8030    3.9547    6.5714    8.7988   18.8896    2.3311]
[xc, yc, theta2, theta3] = Zjie(theta1, theta4, pitch)
l0 = sqrt(xc ^ 2 + yc ^ 2)
theta0 = atan2(xc, yc)
K = zeros(2, 6);
for i = 1:1:6
    for j = 1:1:2
        p = K_coeff((i-1)*2+j,:);
        K(j, i) = polyval(p, l0);
    end
end
disp(K)
X = [0 0 0 0 0 0]';
Xd = [0 0 0.001 0 0 0]';
Torque = K*(Xd - X)
T = Torque(1)
Tp = Torque(2)
F = G_up;
[T1, T2] = VMC(F, Tp)



